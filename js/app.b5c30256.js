(()=>{"use strict";var e={4434:(e,t,s)=>{s(6992),s(8674),s(9601),s(7727);var a=s(8935),n=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{attrs:{id:"app"}},[s("app-header"),s("infinite-message-panel")],1)},r=[],o=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("virtual-list",{attrs:{id:"infiniteMessagePanel","data-key":"id","data-sources":e.filteredMessages,"data-component":e.MessageCard}}),e.showScrollToTop?s("button",{staticClass:"scroll-to-top-button",attrs:{type:"button",title:"Scroll to top"},on:{click:e.scrollToTop}},[e._v("^")]):e._e()],1)},i=[],l=s(7906),u=s(6198),c=s(4479),f=(s(7327),s(1539),s(2772),s(8309),s(2222),s(6647),s(3710),s(9714),s(8783),s(3948),s(1637),s(1703),s(561),function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"message-panel-message-card",attrs:{draggable:""},on:{dragstart:function(t){return e.startDrag(t,e.index)},dragend:function(t){return e.endDrag(t)}}},[s("div",{staticClass:"message-card-top-block"},[s("user-avatar",{attrs:{userUrl:e.userURL}}),s("author-name",{attrs:{message:e.source}})],1),s("span",{staticClass:"message-content"},[e._v(e._s(e.source.content))])])}),m=[],d=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("img",{staticClass:"message-card-user-avatar",attrs:{src:e.imageSource,alt:"user"}})},g=[],p="http://message-list.appspot.com";function h(e){var t=Math.abs((new Date).getTime()-new Date(e).getTime()),s=Math.round(t/1e3),a=Math.round(s/60),n=Math.round(a/60),r=Math.round(n/24),o=Math.round(r/7),i=Math.round(o/52);return i>0?i+" year"+(i>1?"s ago":" ago"):o>0?o+" week"+(o>1?"s ago":" ago"):r>0?r+" day"+(r>1?"s ago":" ago"):n>0?n+" hour"+(n>1?"s ago":" ago"):a>0?a+" minute"+(a>1?"s ago":" ago"):s+" second"+(s>1?"s ago":" ago")}const v={props:["userUrl"],name:"UserAvatar",data:function(){return{imageSource:"",messageURL:p}},mounted:function(){this.imageSource=p+this.userUrl}},M=v;var b=s(1001),T=(0,b.Z)(M,d,g,!1,null,"5ea2c076",null);const y=T.exports;var w=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"message-card-author-name"},[s("span",{staticClass:"author-name"},[e._v(e._s(e.author))]),s("span",{staticClass:"author-name-updated"},[e._v(e._s(e.updated))])])},_=[];const x={props:["message"],name:"AuthorName",data:function(){return{timeToDisplay:"",formatTime:h}},computed:{author:function(){return this.message.author.name},updated:function(){return this.formatTime(this.message.updated)}}},C=x;var N=(0,b.Z)(C,w,_,!1,null,null,null);const S=N.exports,k={props:["index","source"],name:"MessageCard",computed:{userURL:function(){return this.source.author.photoUrl}},components:{UserAvatar:y,AuthorName:S},methods:{startDrag:function(e,t){e.dataTransfer.dropEffect="move",e.dataTransfer.effectAllowed="move",e.dataTransfer.setData("itemIndex",t),e.srcElement.style.opacity="0.5"},endDrag:function(e){e.srcElement.style.opacity="1"}}},E=k;var P=(0,b.Z)(E,f,m,!1,null,"63cdd9dd",null);const D=P.exports;var O=s(8909),$=s.n(O),U=new a["default"];const Z={name:"InfiniteMessagePanel",data:function(){return{showScrollToTop:!1,messages:[],bufferMessages:[],pageToken:"",loading:!1,filterName:"",requestParams:{limit:50},messageURL:p,MessageCard:D}},computed:{filteredMessages:function(){var e=this;return this.filterName?this.messages.filter((function(t){return t.author.name.toLowerCase().indexOf(e.filterName.toLowerCase())>=0})):this.messages}},components:{VirtualList:$()},methods:{onFilterName:function(e){this.filterName=e},scrollToTop:function(){var e=document.getElementById("infiniteMessagePanel");e.scrollTop=0},canFetchMessages:function(){var e=document.getElementById("infiniteMessagePanel");return e.scrollTop>800&&e.clientWidth>800?this.showScrollToTop=!0:this.showScrollToTop=!1,0===e.offsetHeight||e.scrollTop>=e.scrollHeight-e.offsetHeight-200},onScroll:function(){this.loading||this.canFetchMessages()&&this.getMessages()},getMessages:function(){this.bufferMessages&&this.bufferMessages.length&&(this.messages=[].concat((0,c.Z)(this.messages),(0,c.Z)(this.bufferMessages))),this.loadBufferMessages()},loadBufferMessages:function(){var e=this;return(0,u.Z)((0,l.Z)().mark((function t(){var s,a,n;return(0,l.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return s=e.messageURL+"/messages?"+new URLSearchParams(e.requestParams).toString(),e.loading=!0,t.prev=2,t.next=5,fetch(s);case 5:if(a=t.sent,e.loading=!1,!a.ok){t.next=16;break}return t.next=10,a.json();case 10:n=t.sent,e.requestParams.pageToken=n.pageToken,e.bufferMessages=(0,c.Z)(n.messages),e.messages.length||e.getMessages(),t.next=17;break;case 16:throw new Error(a.error);case 17:t.next=23;break;case 19:return t.prev=19,t.t0=t["catch"](2),e.loading=!1,t.abrupt("return");case 23:case"end":return t.stop()}}),t,null,[[2,19]])})))()},onRemoveMessage:function(e){this.messages.splice(e,1)}},mounted:function(){U.$on("on-remove-message",this.onRemoveMessage),U.$on("on-filter-name",this.onFilterName),this.getMessages(),document.getElementById("infiniteMessagePanel").addEventListener("scroll",this.onScroll)},beforeDestroy:function(){U.$off("on-remove-message",this.onRemoveMessage),U.$off("on-filter-name",this.onFilterName),document.getElementById("infiniteMessagePanel").removeEventListener("scroll",this.onScroll)}},L=Z;var j=(0,b.Z)(L,o,i,!1,null,null,null);const R=j.exports;var A=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"infinite-messages-app-header"},[a("div",[e._v("Messages")]),a("input",{directives:[{name:"model",rawName:"v-model",value:e.filterName,expression:"filterName"}],staticClass:"message-filter-input-field",attrs:{type:"text",placeholder:"Filter by name"},domProps:{value:e.filterName},on:{input:function(t){t.target.composing||(e.filterName=t.target.value)}}}),e.filterName?e._e():a("img",{staticClass:"hide-message-icon",attrs:{src:s(5493),height:"20px",alt:"hide"},on:{drop:function(t){return e.onDrop(t)},dragover:function(e){e.preventDefault()},dragenter:function(e){e.preventDefault()}}})])},I=[];const F={name:"AppHeader",data:function(){return{filterName:""}},watch:{filterName:function(){U.$emit("on-filter-name",this.filterName)}},methods:{onDrop:function(e){U.$emit("on-remove-message",e.dataTransfer.getData("itemIndex")),e.preventDefault()}}},B=F;var H=(0,b.Z)(B,A,I,!1,null,null,null);const q=H.exports,V={name:"App",components:{InfiniteMessagePanel:R,AppHeader:q}},W=V;var z=(0,b.Z)(W,n,r,!1,null,null,null);const G=z.exports;a["default"].config.productionTip=!1,new a["default"]({render:function(e){return e(G)}}).$mount("#app")},5493:(e,t,s)=>{e.exports=s.p+"img/hide-icon.cb3e485b.svg"}},t={};function s(a){var n=t[a];if(void 0!==n)return n.exports;var r=t[a]={exports:{}};return e[a].call(r.exports,r,r.exports,s),r.exports}s.m=e,(()=>{var e=[];s.O=(t,a,n,r)=>{if(!a){var o=1/0;for(c=0;c<e.length;c++){for(var[a,n,r]=e[c],i=!0,l=0;l<a.length;l++)(!1&r||o>=r)&&Object.keys(s.O).every((e=>s.O[e](a[l])))?a.splice(l--,1):(i=!1,r<o&&(o=r));if(i){e.splice(c--,1);var u=n();void 0!==u&&(t=u)}}return t}r=r||0;for(var c=e.length;c>0&&e[c-1][2]>r;c--)e[c]=e[c-1];e[c]=[a,n,r]}})(),(()=>{s.n=e=>{var t=e&&e.__esModule?()=>e["default"]:()=>e;return s.d(t,{a:t}),t}})(),(()=>{s.d=(e,t)=>{for(var a in t)s.o(t,a)&&!s.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})}})(),(()=>{s.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()})(),(()=>{s.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t)})(),(()=>{s.r=e=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}})(),(()=>{s.p="/"})(),(()=>{var e={143:0};s.O.j=t=>0===e[t];var t=(t,a)=>{var n,r,[o,i,l]=a,u=0;if(o.some((t=>0!==e[t]))){for(n in i)s.o(i,n)&&(s.m[n]=i[n]);if(l)var c=l(s)}for(t&&t(a);u<o.length;u++)r=o[u],s.o(e,r)&&e[r]&&e[r][0](),e[r]=0;return s.O(c)},a=self["webpackChunkinfinite_scroll"]=self["webpackChunkinfinite_scroll"]||[];a.forEach(t.bind(null,0)),a.push=t.bind(null,a.push.bind(a))})();var a=s.O(void 0,[998],(()=>s(4434)));a=s.O(a)})();
//# sourceMappingURL=app.b5c30256.js.map